##
## Splunk Technology Add-on for Model Context Protocol (MCP)
## transforms.conf
##

# Optional: Filter out notification messages if volume is too high
[setnull_notifications]
REGEX = "method"\s*:\s*"notifications/
DEST_KEY = queue
FORMAT = nullQueue

# Optional: Route different server types to different indexes
[route_to_mcp_filesystem]
SOURCE_KEY = MetaData:Sourcetype
REGEX = mcp:jsonrpc
DEST_KEY = _MetaData:Index
FORMAT = mcp_filesystem

# Extract server type from filename
[extract_server_type]
SOURCE_KEY = source
REGEX = /([^/]+)\.jsonl$
FORMAT = server_type::$1
WRITE_META = true

# Mask sensitive data in file paths (optional - uncomment if needed)
# [mask_sensitive_paths]
# REGEX = ("path"\s*:\s*")[^"]*(/etc/shadow|\.ssh/|\.key|\.pem)([^"]*)
# FORMAT = $1***REDACTED***$3
# DEST_KEY = _raw
