# Example redaction pipeline for prompts/responses (basic content masking).
[ollama_redact_prompts]
REGEX = ("(prompt|response|content)"\s*:\s*")(.*?)(")
FORMAT = "$1[REDACTED]$3"
DEST_KEY = _raw

# Extract web fields from GIN logs - handles both IPv4 and IPv6, all time units
# CIM 5.0+ compliant extraction
# Handles variable-width padding in GIN log format
[ollama_web_extraction]
REGEX = \[GIN\]\s+[^|]+\|\s+(\d+)\s+\|\s+([^\|]+?)\s+\|\s+([^\|]+?)\s+\|\s+(\w+)\s+"([^"]+)"
FORMAT = status::$1 response_time::$2 src::$3 http_method::$4 uri_path::$5 http_response_code::$1